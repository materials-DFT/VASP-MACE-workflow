model:
  _target_: allegro.model.AllegroModel
  seed: 456
  model_dtype: float64
  type_names:
  - K
  - Mn
  - O
  r_max: 5.0
  radial_chemical_embed:
    _target_: allegro.nn.TwoBodyBesselScalarEmbed
    num_bessels: 8
    bessel_trainable: false
    polynomial_cutoff_p: 6
  radial_chemical_embed_dim: 64
  scalar_embed_mlp_hidden_layers_depth: 1
  scalar_embed_mlp_hidden_layers_width: 64
  scalar_embed_mlp_nonlinearity: silu
  l_max: 2
  num_layers: 3
  num_scalar_features: 64
  num_tensor_features: 64
  allegro_mlp_hidden_layers_depth: 1
  allegro_mlp_hidden_layers_width: 64
  allegro_mlp_nonlinearity: silu
  parity: false
  tp_path_channel_coupling: true
  readout_mlp_hidden_layers_depth: 1
  readout_mlp_hidden_layers_width: 64
  readout_mlp_nonlinearity: silu
  avg_num_neighbors: 51.54486821546584
  per_type_energy_scales: 1.2469784671856505
  per_type_energy_scales_trainable: true
  per_type_energy_shifts_trainable: false
optimizer:
  _target_: torch.optim.Adam
  lr: 0.001
lr_scheduler: null
loss:
  _target_: nequip.train.EnergyForceLoss
  per_atom_energy: true
  coeffs:
    total_energy: 1.0
    forces: 10.0
train_metrics: null
val_metrics:
  _target_: nequip.train.EnergyForceMetrics
  coeffs:
    per_atom_energy_mae: 1.0
    forces_mae: 1.0
test_metrics:
  _target_: nequip.train.EnergyForceMetrics
  coeffs:
    per_atom_energy_mae: 1.0
    forces_mae: 1.0
num_datasets:
  train: 1
  val: 1
  test: 0
  predict: 0
info_dict:
  versions:
    torch: 2.4.1+cu118
    e3nn: 0.5.8
    nequip: 0.15.0
    allegro: 0.7.1
  data:
    _target_: nequip.data.datamodule.NequIPDataModule
    seed: 6699
    split_dataset:
      dataset:
        _target_: nequip.data.dataset.ASEDataset
        file_path: final_frames.xyz
        include_keys:
        - REF_energy
        - REF_forces
        key_mapping:
          REF_energy: total_energy
          REF_forces: forces
        transforms:
        - _target_: nequip.data.transforms.NeighborListTransform
          r_max: 5.0
        - _target_: nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper
          chemical_symbols:
          - K
          - Mn
          - O
      train: 0.95
      val: 0.05
    train_dataloader:
      _target_: torch.utils.data.DataLoader
      batch_size: 1
      shuffle: true
    val_dataloader:
      _target_: torch.utils.data.DataLoader
      batch_size: 1
    test_dataloader:
      _target_: torch.utils.data.DataLoader
      batch_size: 1
    stats_manager:
      _target_: nequip.data.CommonDataStatisticsManager
      type_names:
      - K
      - Mn
      - O
  trainer:
    _target_: lightning.Trainer
    max_epochs: 500
    check_val_every_n_epoch: 1
    log_every_n_steps: 1
    accelerator: gpu
    devices: 4
    callbacks:
    - _target_: nequip.train.callbacks.SoftAdapt
      beta: 1.0
      interval: epoch
      frequency: 2
    - _target_: lightning.pytorch.callbacks.ModelCheckpoint
      monitor: val0_epoch/weighted_sum
      dirpath: models
      filename: best
      save_last: true
    - _target_: lightning.pytorch.callbacks.LearningRateMonitor
      logging_interval: epoch
    logger:
      _target_: lightning.pytorch.loggers.CSVLogger
      name: cohs
      save_dir: logs
    strategy: ddp
  global_options:
    allow_tf32: false
  runs:
  - train
  - val
  training_module:
    _target_: nequip.train.EMALightningModule
    loss:
      _target_: nequip.train.EnergyForceLoss
      per_atom_energy: true
      coeffs:
        total_energy: 1.0
        forces: 10.0
    val_metrics:
      _target_: nequip.train.EnergyForceMetrics
      coeffs:
        per_atom_energy_mae: 1.0
        forces_mae: 1.0
    test_metrics:
      _target_: nequip.train.EnergyForceMetrics
      coeffs:
        per_atom_energy_mae: 1.0
        forces_mae: 1.0
    optimizer:
      _target_: torch.optim.Adam
      lr: 0.001
    model:
      _target_: allegro.model.AllegroModel
      seed: 456
      model_dtype: float64
      type_names:
      - K
      - Mn
      - O
      r_max: 5.0
      radial_chemical_embed:
        _target_: allegro.nn.TwoBodyBesselScalarEmbed
        num_bessels: 8
        bessel_trainable: false
        polynomial_cutoff_p: 6
      radial_chemical_embed_dim: 64
      scalar_embed_mlp_hidden_layers_depth: 1
      scalar_embed_mlp_hidden_layers_width: 64
      scalar_embed_mlp_nonlinearity: silu
      l_max: 2
      num_layers: 3
      num_scalar_features: 64
      num_tensor_features: 64
      allegro_mlp_hidden_layers_depth: 1
      allegro_mlp_hidden_layers_width: 64
      allegro_mlp_nonlinearity: silu
      parity: false
      tp_path_channel_coupling: true
      readout_mlp_hidden_layers_depth: 1
      readout_mlp_hidden_layers_width: 64
      readout_mlp_nonlinearity: silu
      avg_num_neighbors: 51.54486821546584
      per_type_energy_scales: 1.2469784671856505
      per_type_energy_scales_trainable: true
      per_type_energy_shifts_trainable: false
ema_decay: 0.999
